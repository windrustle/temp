with addr as(select aoguid, oktmo_uid, postalcode, 'T' || ceil(random()*999) housenum, public.uuid_generate_v4() houseguid from nsism.nsi_addrobj where is_actual = true and aolevel = '7' and regioncode = '74' and oktmo_uid is not null limit 1)
insert into	nsism.nsi_house(houseid,houseguid,aoguid,postalcode,oktmo_uid,housenum,eststatus,buildnum,strucnum,strstatus,status_uid,fias_update_date,start_date,end_date,create_date,last_event_date,is_actual,parent_aoguid,additional_name,fias_houseid,fias_houseguid,is_added_manually,cadnum,divtype,is_aggregated)
values((select houseguid from addr),(select houseguid from addr),(select aoguid from addr),(select postalcode from addr),(select oktmo_uid from addr),(select housenum from addr),'0',null,null,'0','4979fb1a-8373-4f99-b87b-0c4ee832da15',now(),now(),now()+interval '10 years',now(),now(),true,(select aoguid from addr),null,null,null,true,null,null,false);
